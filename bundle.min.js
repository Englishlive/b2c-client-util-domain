!function(n,t){"function"==typeof define&&define.amd?define([],function(){return n.returnExportsGlobal=t()}):"object"==typeof exports?module.exports=t():n.bundle=t()}(this,function(){var n;n=function(){var n;return function(n,u,r){var f,s="resolve",c="reject",l="resolved",h="rejected",E="pending",N="promise",a="call",_="result",G="error";function I(n,t,e){var i;try{i=n[a](f,t)}catch(n){S(n),e[c](n)}return i}function L(){this[N]._s=[],this[N]._f=[],this[N]._d=[]}function S(n){u.f(H.onError)&&H.onError(n)}function v(n){var t,e=this,i=e[N];i[l]||i[h]||i[E]||(i[E]=!0,t=n,i[G]=t,i[h]=!0,i[E]=!1,r(function(){for(var n=0;n<i._f.length;n++)I(i._f[n],i[G],i._d[n]);L[a](e)}))}function g(e,i){return function(t){r(function(){var n=I(e,t,i);T(i[s],i[c],i[s],i,n)})}}function T(t,e,n,i,o){var r,s;try{r=("object"==typeof o||u.f(o))&&o&&o.then}catch(n){return S(n),void e[a](i,n)}if(o===i[N])e[a](i,new TypeError(1));else if(u.f(r))try{r[a](o,function(n){s||(s=!0,t[a](i,n))},function(n){s||(s=!0,e[a](i,n))})}catch(n){if(s)return;s=!0,S(n),e[a](i,n)}else o===f?n[a](i):n[a](i,o)}function H(n){if(!(this instanceof H))return new H(n);var t=this;t[N]=n&&u.f(n.then)?n:new e(t),t[s]=function(n){(function(n){var e=this,i=e[N];function o(n){i[_]=n,i[l]=!0,i[E]=!1,r(function(){for(var n=0;n<i._s.length;n++)I(i._s[n],i[_],i._d[n]);L[a](e)})}i[l]||i[h]||i[E]||(i[E]=!0,function n(t){T(n,function(n){i[E]=!1,v[a](e,n)},o,e,t)}(n))})[a](t,n)},t[c]=function(n){v[a](t,n)}}function e(n){if(!(this instanceof e))return new e(n);if(this._s=[],this._f=[],this._d=[],this._defer=n&&n instanceof H?n:new H(this),this[l]=!1,this[h]=!1,this[E]=!1,this[_]=null,this[G]=null,u.f(n))try{n[a](this,this._defer[s],this._defer[c])}catch(n){S(n),this._defer[c](n)}}return e.prototype.then=function(n,t){var e,i,o=new H,r=this;return r._d.push(o),r[h]||(e=u.f(n)?g[a](r,n,o):o[s],r[l]?e[a](null,r[_]):r._s.push(e)),r[l]||(i=u.f(t)?g[a](r,t,o):o[c],r[h]?i[a](null,r[G]):r._f.push(i)),o[N]},H.Promise=e,H[s]=function(n){var t=new H;return t[s](n),t[N]},H[c]=function(n){var t=new H;return t[c](n),t[N]},n(H),H}(function(u){function f(t,e,i,o,r){return function(n){t[e]=n,r.value++,o.value===r.value&&i(t)}}return function(n){n.all=function(s){return new n.Promise(function(n,t){for(var e={value:s.length},i={value:0},o=[],r=s.length;r--;)s[r]&&u.f(s[r].then)?s[r].then(f(o,r,n,e,i),t):(o[r]=s[r],e.value--);(e.value<=0||e.value===i.value)&&n(o)})}}}(n={f:function(n){return"function"==typeof n}}),n,function(n){n()})},this.returnExportsGlobal=n();var t=function(n){"use strict";var o="live",r="qa",s="stg",u="dev";c.ENGLISHLIVE="englishlive.ef.com",c.ENGLISHLIVE_QA="qa-englishlive.ef.com",c.ENGLISHLIVE_STAGING="stg-englishlive.ef.com",c.ENGLISHTOWN="englishtown.com",c.ENGLISHTOWN_SEO="efenglishtown.com",c.ENGLISHTOWN_JP="englishtown.co.jp",c.ENGLISHTOWN_MX="englishtown.com.mx",c.ENGLISHTOWN_RU="englishtown.ru",c.ENGLISHTOWN_BR="englishtown.com.br",c.ENGLISHTOWN_CN="englishtown.cn",c.ENGLISHTOWN_CN_LEGACY="englishtown.com.cn",c.ENGLISHTOWN_FR="englishtown.fr",c.ENGLISHTOWN_DE="englishtown.de",c.ENGLISHTOWN_ES="englishtown.es",c.ENGLISHCENTER="englishcenters.ef.com",c.ENGLISHCENTER_QA="qa-englishcenters.ef.com",c.ENGLISHCENTER_STAGING="stg-englishcenters.ef.com",c.englishLives=[c.ENGLISHLIVE,c.ENGLISHLIVE_QA,c.ENGLISHLIVE_STAGING],c.englishCenters=[c.ENGLISHCENTER,c.ENGLISHCENTER_QA,c.ENGLISHCENTER_STAGING],c.englishTowns=[c.ENGLISHTOWN,c.ENGLISHTOWN_JP,c.ENGLISHTOWN_MX,c.ENGLISHTOWN_RU,c.ENGLISHTOWN_BR,c.ENGLISHTOWN_CN,c.ENGLISHTOWN_CN_LEGACY,c.ENGLISHTOWN_FR,c.ENGLISHTOWN_DE,c.ENGLISHTOWN_ES],c.all=[c.ENGLISHTOWN_SEO].concat(c.englishLives).concat(c.englishTowns).concat(c.englishCenters),(c.env={}).LIVE=o,c.env.STAGING=s,c.env.QA=r,c.env.DEV=u;var i=[{code:"br",domain:c.ENGLISHTOWN_BR,brand:"englishtown"}];function f(t){return new n(function(n){n(t)})}function t(e){return new n(function(n,t){t(e)})}function c(n){if(null==n)throw new Error("domain must be specified");this.domain=n.toLowerCase(),this.is=new h(this),this.get=new l(this),this.set=new e(this)}function e(n){this._context=n}function l(n){this._context=n}function h(n){this._context=n}return c.get={by:function(n){return null==n?t("Option must be specified"):n.market?f(function(n){for(var t,e=i.length;e--;)if((t=i[e]).code==n)return t.domain;return c.ENGLISHLIVE}(n.market)):t("Option is empty or unknown")}},c.config={getMarket:null},c.prototype.toString=function(){return this.domain},e.prototype.env=function(n){var t=this._context.get.topLevel(c.all),e=!1,i=c.ENGLISHLIVE;null!=t&&(t!==c.ENGLISHLIVE&&t!==c.ENGLISHLIVE_QA&&t!==c.ENGLISHLIVE_STAGING&&t!==c.ENGLISHCENTER&&t!==c.ENGLISHCENTER_QA&&t!==c.ENGLISHCENTER_STAGING||(e=!0),e?(function(n,t){if("function"==typeof n.indexOf)return 0<=n.indexOf(t);for(var e=0;e<n.length;e++)return n[e]===t}(c.englishCenters,t)&&(i=c.ENGLISHCENTER),n===o?this._context.domain=i:n===s?this._context.domain="stg-"+i:n===r?this._context.domain="qa-"+i:n===u&&(this._context.domain="dev-"+i)):n===o?this._context.domain="www."+t:n===s?this._context.domain="staging."+t:n===r?this._context.domain="qa."+t:n===u&&(this._context.domain="local."+t))},l.prototype.topLevel=function(n){for(var t=null,e=n.length;e--;)if(null!==this.subsOf(n[e])){t=n[e];break}return t},l.prototype.subsOf=function(n){var t,e,i=this._context.domain.split("."),o=n.split("."),r=0,s=[];for(e=o.length;e--;)if(r=i.length-(o.length-e),o[e]!==i[r]){s=null;break}if(null===s)return s;for(t=0;t<r;t++)s.push(i[t]);return s},l.prototype.env=function(){var n=this.topLevel(c.all);if(null==n)return null;var t=this.subsOf(n);return null==t?null:n===c.ENGLISHLIVE_QA||n===c.ENGLISHCENTER_QA?r:n===c.ENGLISHLIVE_STAGING||n===c.ENGLISHCENTER_STAGING?s:t[0]===r||t[0]==s||t[0]==u?t[0]:"staging"===t[0]?s:"local"===t[0]?u:o},l.prototype.secure=function(){var t=this;if(!t._context.is.subOf(c.ENGLISHTOWN_SEO))return f(t._context.domain);var e,i=t.env(),o="";return c.config.getMarket().then(function(n){e=n,t._context.is.subOf(c.englishTowns)?i===c.env.LIVE?o="www.":i===c.env.QA?o="qa.":i===c.env.STAGING&&(o="staging."):i===c.env.QA?o="qa-":i===c.env.STAGING&&(o="stg-")}).then(function(){return c.get.by({market:e})}).then(function(n){return f(o+n)})},h.prototype.subOf=function(n){if("object"==typeof n&&"length"in n){for(var t=n.length;t--;)if(this.subOf(n[t]))return!0;return!1}return null!==this._context.get.subsOf(n)},h.prototype.ours=function(){return this.subOf(c.all)},c}(function(n){"use strict";return window.Promise||n.Promise}(Defer));return function(n){"use strict";return{Domain:t}}()});